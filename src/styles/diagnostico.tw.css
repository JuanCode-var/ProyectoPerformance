/* Tailwind runtime */
@import "tailwindcss";
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ========== BASE (tokens + preflight extra) ========== */
@layer base {
  :root {
    /* Paleta / tokens */
    --primary-color:#0f172a; --primary-light:#1e293b;
    --accent-color:#3b82f6; --accent-hover:#2563eb;
    --success-color:#10b981; --warning-color:#f59e0b; --error-color:#ef4444;

    --text-primary:#0f172a; --text-secondary:#64748b; --text-muted:#94a3b8;
    --bg-primary:#fff; --bg-secondary:#f8fafc; --bg-tertiary:#f1f5f9;
    --border-color:#e2e8f0;

    --shadow-sm:0 1px 2px 0 rgba(0,0,0,.05);
    --shadow-md:0 4px 6px -1px rgba(0,0,0,.1), 0 2px 4px -1px rgba(0,0,0,.06);
    --shadow-lg:0 10px 15px -3px rgba(0,0,0,.1), 0 4px 6px -2px rgba(0,0,0,.05);
    --shadow-xl:0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04);

    --gradient-accent: linear-gradient(135deg,#3b82f6 0%,#1d4ed8 100%);
  }

  * { @apply box-border; }
  body {
    @apply min-h-screen m-0 p-0;
    font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: linear-gradient(135deg,#f8fafc 0%, #e2e8f0 100%);
    color: var(--text-primary);
  }

  /* Tipos de medios más suaves */
  img, svg, video { @apply select-none; }

  /* Bordes por defecto de Tailwind, atados a tu token */
  * { @apply border-[var(--border-color)]; }
}

/* ========== COMPONENTS (UI reutilizable) ========== */
@layer components {
  /* Contenedor responsivo */
  .screen-wrap { @apply max-w-[1280px] mx-auto px-4 md:px-6 lg:px-8; }

  /* Card principal */
  .card {
    @apply relative mx-auto my-8 rounded-2xl border p-8 backdrop-blur;
    background: var(--bg-primary);
    box-shadow: var(--shadow-xl);
    overflow: hidden;
  }
  .card::before {
    content: "";
    @apply absolute left-0 right-0 top-0 h-1 rounded-t-2xl;
    background: var(--gradient-accent);
  }

  /* Botón/enlace de vuelta */
  .back-link {
    @apply inline-flex items-center gap-2 rounded-lg border px-4 py-2 text-sm font-medium no-underline transition mb-6;
    color: var(--accent-color);
    background: var(--bg-secondary);
  }
  .back-link:hover {
    background: var(--accent-color);
    color: #fff;
    transform: translateY(-1px);
    box-shadow: var(--shadow-md);
  }
  .back-link::before { content: "←"; font-size: 16px; }

  /* Título */
  .title { @apply m-0 mb-2 text-4xl font-bold leading-tight text-slate-900; }
  .title .url { color: var(--accent-color); @apply font-semibold break-all; }

  .diagnostico-title {
    @apply m-0 mb-2 text-4xl font-bold leading-tight;
    color: var(--text-primary);
    background: var(--gradient-accent);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .date { @apply mb-6 text-sm font-medium text-slate-400; }

  /* Mensaje de éxito/estado */
  .success-msg {
    @apply mb-6 inline-flex items-center gap-2 rounded-xl border px-5 py-3 text-sm font-medium;
    color: var(--success-color);
    background: linear-gradient(135deg,#ecfdf5 0%, #d1fae5 100%);
    border-color: #a7f3d0;
  }
  .success-msg::before { content: "✓"; font-weight: 700; }

  /* Grid de tarjetas principales */
  .diagnostico-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 24px;
    margin-top: 32px;
  }
  .item {
    @apply relative overflow-hidden rounded-2xl border p-6 text-center transition;
    background: var(--bg-primary);
    box-shadow: var(--shadow-sm);
  }
  .item::before {
    content: "";
    @apply absolute left-0 right-0 top-0 h-[3px];
    background: var(--gradient-accent);
    transform: scaleX(0);
    transition: transform .3s ease;
  }
  .item:hover { @apply -translate-y-2; box-shadow: var(--shadow-xl); border-color: var(--accent-color); }
  .item:hover::before { transform: scaleX(1); }

  .item-label { @apply mb-4 text-sm font-semibold uppercase tracking-wide text-slate-900; }
  .item-value { @apply mt-4 text-2xl font-bold leading-none text-slate-900; }
  .item-desc  { @apply mt-3 text-sm leading-6 text-slate-500; }

  /* Loading */
  .loading { @apply px-8 py-16 text-center; }
  .loading-placeholder { @apply mt-16 flex flex-col items-center text-slate-500; }
  .spinner {
    @apply mx-auto my-6 h-14 w-14 rounded-full border-4 border-slate-200;
    border-top-color: var(--accent-color);
    animation: spin 1s linear infinite;
  }

  /* Gauges */
  .gauges-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px; }
  .gauge-card { @apply rounded-2xl border p-6 shadow-md transition; background: var(--bg-primary); }
  .gauge-card:hover { @apply -translate-y-1 shadow-xl; }

  /* Tabs */
  .tabs { @apply mb-6 flex gap-2 rounded-xl border p-1; background: var(--bg-secondary); }
  .tab-button { @apply flex-1 cursor-pointer rounded-lg px-5 py-3 text-sm font-medium text-slate-500 transition; background: none; border: none; }
  .tab-button.active { @apply shadow-sm text-white; background: var(--gradient-accent); }
  .tab-button:hover:not(.active) { @apply bg-white text-slate-900; }

  /* Métricas listas */
  .metrics-title { @apply mt-8 mb-4 text-2xl font-semibold text-slate-900; }
  .metrics-list { @apply m-0 grid list-none gap-3 p-0; }
  .metrics-list li { @apply flex items-center gap-3 rounded-xl border bg-slate-50 px-5 py-4 text-sm font-medium text-slate-900; }
  .metrics-list li::before { content: "▶"; color: var(--accent-color); font-size: 12px; }

  /* Estados */
  .error { @apply flex items-center gap-3 rounded-xl border px-5 py-4 font-semibold; color: var(--error-color); background: #fef2f2; border-color: #fecaca; }
  .error::before { content: "⚠"; font-size: 18px; }
}

/* ========== UTILITIES (pequeñas ayudas) ========== */
@layer utilities {
  @keyframes spin { to { transform: rotate(360deg); } }

  .pressable { @apply transition active:translate-y-px; }
  .focus-ring { @apply outline-none ring-2 ring-offset-2 ring-[color:var(--accent-color)]/50; }

  /* “Shift” opcional hacia la derecha en pantallas grandes */
  .shift-right      { @apply xl:ml-10 2xl:ml-20; }
  .card-shift-right { @apply xl:ml-6  2xl:ml-10; }

  /* Evitar cortes en PDF */
  .pdf-keep { break-inside: avoid; page-break-inside: avoid; }
  .pdf-page { break-after: page; page-break-after: always; }
}

/* ========== Encabezado Diagnóstico ========== */
.diagnostico-header h1 { @apply text-3xl font-bold leading-tight break-words; }
.diagnostico-header small,
.diagnostico-header .subtitle { @apply text-sm text-gray-500; }

/* ========== MODO CAPTURA PDF (para html2canvas/jsPDF) ========== */
/* soporta tanto .pdf-capture como .pdf-root (tu EmailPdfBar usa .pdf-root) */
.pdf-capture body, .pdf-root body { background: #ffffff !important; }
.pdf-capture *, .pdf-root * {
  animation: none !important;
  transition: none !important;
  filter: none !important;
  text-shadow: none !important;
}
.pdf-capture .card, .pdf-root .card {
  box-shadow: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  border-top: 4px solid var(--accent-color) !important;
}
.pdf-capture .card::before, .pdf-root .card::before { content: none !important; }
.pdf-capture .diagnostico-title, .pdf-root .diagnostico-title {
  background: none !important;
  -webkit-background-clip: initial !important;
  -webkit-text-fill-color: initial !important;
  color: var(--text-primary) !important;
}
.pdf-capture .title .url,
.pdf-capture .diagnostico-header h1,
.pdf-root .title .url,
.pdf-root .diagnostico-header h1 {
  word-break: break-all !important;
  overflow-wrap: anywhere !important;
}
.pdf-capture .item:hover, .pdf-capture .gauge-card:hover,
.pdf-root .item:hover, .pdf-root .gauge-card:hover {
  transform: none !important;
  box-shadow: none !important;
}
/* No partir bloques */
.pdf-capture .card, .pdf-capture .item, .pdf-capture .gauge-card, .pdf-capture .metrics-list li, .pdf-capture .error,
.pdf-root .card, .pdf-root .item, .pdf-root .gauge-card, .pdf-root .metrics-list li, .pdf-root .error {
  break-inside: avoid; page-break-inside: avoid;
}
/* Barra sólida Lighthouse en PDF */
.pdf-capture .lighthouse-bar, .pdf-root .lighthouse-bar {
  background: #2563eb !important;
  height: 12px !important;
  border-radius: 9999px !important;
}
/* Ajustes de paddings en PDF */
.pdf-capture .container, .pdf-capture .card,
.pdf-root .container, .pdf-root .card { padding-left: 1rem !important; padding-right: 1rem !important; }

/* ========== Responsive ========== */
@media (max-width:768px){
  .card{ @apply mx-4 rounded-xl px-5 py-6; }
  .diagnostico-grid{ grid-template-columns:1fr; gap:16px; }
  .title,.diagnostico-title{ @apply text-3xl; }
  .tabs{ @apply flex-col; }
  .tab-button{ @apply text-center; }
}
@media (max-width:480px){
  .card{ @apply mx-3 p-4; }
  .item{ @apply p-4; }
  .item-value{ @apply text-2xl; }
}

@layer components {
  /* Contenedor de acciones (alineado a la derecha) */
  .pdf-actions {
    @apply mt-6 flex flex-wrap items-center justify-end gap-3;
  }

  /* Input de email opcional */
  .pdf-email-input {
    @apply min-w-[260px] rounded-xl border border-slate-200 bg-white/90 px-4 py-2
           text-sm text-slate-900 shadow-sm backdrop-blur
           placeholder:text-slate-400
           focus:outline-none focus:ring-4 focus:ring-blue-500/10 focus:border-blue-500;
  }

  /* Botón primario reutilizable */
  .btn-primary {
    @apply inline-flex items-center gap-2 rounded-xl
           bg-gradient-to-br from-blue-500 to-blue-700
           px-4 py-2 text-sm font-semibold text-white
           shadow-sm transition
           hover:-translate-y-[1px] hover:shadow-md
           focus-visible:outline-none focus-visible:ring-4 focus-visible:ring-blue-500/20
           disabled:opacity-60 disabled:cursor-not-allowed;
  }

  /* Variante “enviar” (por si quieres diferenciar márgenes/tamaños) */
  .pdf-send-btn {
    @apply min-w-[220px] justify-center;
  }

  /* Spinner dentro del botón */
  .btn-spinner {
    @apply h-4 w-4 animate-spin rounded-full border-2 border-white/30 border-t-white;
  }

  /* Mensajes de estado */
  .pdf-msg { @apply text-sm font-medium; }
  .pdf-msg.is-error { @apply text-red-600; }
  .pdf-msg.is-ok    { @apply text-emerald-600; }
}

@layer components {
  /* contenedor */
  .strategy-tabs {
    @apply w-full mt-4 flex justify-center;
  }

  /* “pastilla” que agrupa los 2 botones */
  .strategy-list {
    @apply inline-flex gap-1 rounded-2xl border border-slate-200 bg-white p-1 shadow-sm;
  }

  /* botón base */
  .strategy-trigger {
    @apply px-5 py-2 rounded-xl text-sm font-medium text-slate-600 transition
           data-[state=inactive]:bg-transparent;
  }

  /* hover cuando NO está activo */
  .strategy-trigger:hover:not([data-state="active"]) {
    @apply bg-blue-50 text-blue-700;
  }

  /* estado ACTIVO (lo pone shadcn con data-state="active") */
  .strategy-trigger[data-state="active"] {
    @apply text-white bg-gradient-to-r from-blue-500 to-blue-700 shadow;
  }
}

@layer components {
  /* Grupo de botones de diagnóstico (más visibles) */
  .diagnostico-btn-group {
    @apply flex gap-4 mb-6 mt-2;
    justify-content: flex-start;
  }
  .diagnostico-btn-group .btn-primary {
    @apply text-lg px-6 py-3 font-bold shadow-lg;
    box-shadow: 0 4px 16px 0 rgba(59,130,246,0.10);
  }
}
